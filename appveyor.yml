version: 4.0.0-rc-{build}
image:
- Visual Studio 2019
- Ubuntu

nuget:
  project_feed: true
  disable_publish_on_pr: true
build_script:
- ps: >-

    .\Scripts\build.ps1

test_script:
- ps: >-

    # run tests

    .\Scripts\runTests.ps1

for:

-
  branches:
    only:
      - master

  on_success:
  - ps: |
        if ($isLinux) {
          dotnet publish ./Src/Kronos.Server/ -c Release -o ./dockerPackage
          docker login -u="$env:DOCKER_USER" -p="$env:DOCKER_PASSWORD"
          docker build -t lukaszpyrzyk/kronos .
          docker push lukaszpyrzyk/kronos
        }
