version: 4.0.0-rc-{build}
image:
- Visual Studio 2019 Preview
- Ubuntu
- macos

nuget:
  project_feed: true
  disable_publish_on_pr: true
build_script:
- ps: >-

    .\Scripts\build.ps1

test_script:
- ps: >-

    # run tests

    .\Scripts\runTests.ps1

for:

-
  branches:
    only:
      - master

  on_success:
  - ps: |
        if ($isLinux) {
          cd ./Src/Kronos.Server/
          dotnet publish -c Release
          docker login -u="$env:DOCKER_USER" -p="$env:DOCKER_PASSWORD"
          docker build -t lukaszpyrzyk/kronos .
          docker push lukaszpyrzyk/kronos
        }
